Nr of Trainable Params on cuda:   89697
> /home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py(149)forward()
-> out = self.nn[0](x.permute(1,0,2,3))
  0%|                                                                                                                         | 0/18627 [00:00<?, ?it/s]
tensor([[[[-0.9642, -0.9622, -0.9602,  ..., -0.9668, -0.9662, -0.9655],
          [-0.9244, -0.9264, -0.9257,  ..., -0.9178, -0.9198, -0.9224],
          [-0.9052, -0.9237, -0.9377,  ..., -0.8740, -0.8740, -0.8846],
          ...,
          [-0.3349, -0.3282, -0.3210,  ..., -0.3408, -0.3442, -0.3415],
          [-0.3137, -0.3157, -0.3176,  ..., -0.3090, -0.3103, -0.3117],
          [-0.3110, -0.3110, -0.3110,  ..., -0.3117, -0.3117, -0.3110]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]],
        [[[-0.8675, -0.8696, -0.8717,  ..., -0.8633, -0.8640, -0.8654],
          [-0.9074, -0.9222, -0.9313,  ..., -0.8506, -0.8696, -0.8885],
          [-0.8654, -0.8878, -0.9011,  ..., -0.7686, -0.8036, -0.8373],
          ...,
          [-0.6297, -0.6543, -0.6802,  ..., -0.5856, -0.5961, -0.6101],
          [-0.6059, -0.6150, -0.6241,  ..., -0.5863, -0.5912, -0.5975],
          [-0.6003, -0.6073, -0.6136,  ..., -0.5799, -0.5870, -0.5940]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]],
        [[[-0.6124, -0.6130, -0.6130,  ..., -0.6124, -0.6118, -0.6118],
          [-0.6879, -0.6979, -0.7050,  ..., -0.6590, -0.6690, -0.6796],
          [-0.8301, -0.8572, -0.8590,  ..., -0.7145, -0.7587, -0.7988],
          ...,
          [-0.4071, -0.4230, -0.4271,  ..., -0.3740, -0.3829, -0.3935],
          [-0.3487, -0.3445, -0.3375,  ..., -0.3428, -0.3469, -0.3493],
          [-0.2985, -0.2979, -0.2973,  ..., -0.3032, -0.3015, -0.2997]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]],
        ...,
        [[[-0.7953, -0.7947, -0.7947,  ..., -0.8004, -0.7985, -0.7966],
          [-0.7050, -0.7012, -0.7018,  ..., -0.7381, -0.7241, -0.7127],
          [-0.6605, -0.6618, -0.6643,  ..., -0.7050, -0.6796, -0.6650],
          ...,
          [-0.5442, -0.5639, -0.5804,  ..., -0.4787, -0.4971, -0.5219],
          [-0.5194, -0.5270, -0.5359,  ..., -0.4997, -0.5060, -0.5130],
          [-0.5156, -0.5168, -0.5188,  ..., -0.5137, -0.5137, -0.5143]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]],
        [[[-0.8554, -0.8534, -0.8508,  ..., -0.8606, -0.8586, -0.8573],
          [-0.8455, -0.8298, -0.8168,  ..., -0.8966, -0.8829, -0.8645],
          [-0.7598, -0.7487, -0.7349,  ..., -0.7546, -0.7605, -0.7631],
          ...,
          [-0.5825, -0.5812, -0.5949,  ..., -0.5916, -0.5864, -0.5838],
          [-0.6165, -0.6126, -0.6113,  ..., -0.6368, -0.6289, -0.6224],
          [-0.6440, -0.6420, -0.6401,  ..., -0.6505, -0.6479, -0.6459]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]],
        [[[-0.6976, -0.6997, -0.7018,  ..., -0.6907, -0.6928, -0.6956],
          [-0.7233, -0.7337, -0.7420,  ..., -0.6727, -0.6859, -0.7046],
          [-0.6318, -0.6449, -0.6560,  ..., -0.6103, -0.6165, -0.6221],
          ...,
          [-0.7996, -0.7899, -0.7802,  ..., -0.8003, -0.8072, -0.8065],
          [-0.9417, -0.9438, -0.9438,  ..., -0.9161, -0.9300, -0.9376],
          [-0.8488, -0.8523, -0.8544,  ..., -0.8329, -0.8391, -0.8447]],
         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]]],
       device='cuda:0')
> /home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py(150)forward()
-> out = self.nn[1](out)
> /home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py(151)forward()
-> return out
torch.Size([32, 16, 32, 64])
*** AttributeError: 'GatedConvNet' object has no attribute 'net'
Sequential(
  (0): Conv3d(2, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
  (1): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (2): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (3): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (4): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (5): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (6): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (7): ConcatRELU()
  (8): Conv3d(64, 1, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
)
*** RuntimeError: Given groups=1, weight of size [32, 2, 3, 3, 3], expected input[1, 16, 2, 32, 64] to have 2 channels, but got 16 channels instead
Conv3d(64, 1, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
Sequential(
  (0): Conv3d(2, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
  (1): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (2): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (3): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (4): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (5): GatedConv(
    (net): Sequential(
      (0): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
      (1): ConcatRELU()
      (2): Conv3d(32, 32, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    )
  )
  (6): InstanceNorm3dChannel(
    (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
  )
  (7): ConcatRELU()
  (8): Conv3d(64, 1, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
)
InstanceNorm3dChannel(
  (instance_norm): InstanceNorm3d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
)
*** NameError: name 'sel' is not defined
*** RuntimeError: Given groups=1, weight of size [1, 64, 3, 3, 3], expected input[1, 32, 32, 32, 64] to have 64 channels, but got 32 channels instead
  0%|                                                                                                                         | 0/18627 [06:09<?, ?it/s]
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py", line 88, in trainer
    out = model.forward(x=x_past)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 70, in forward
    h,c = self.convLSTMcell(x[:,:,time_step],(h,c))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 107, in forward
    out = self.gated_conv_net(X).cuda()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 151, in forward
    out = self.nn[2](out)
           ^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py", line 88, in trainer
    out = model.forward(x=x_past)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 70, in forward
    h,c = self.convLSTMcell(x[:,:,time_step],(h,c))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 107, in forward
    out = self.gated_conv_net(X).cuda()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 151, in forward
    out = self.nn[2](out)
           ^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit