Nr of Trainable Params on cuda:   1387521
> /home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py(158)forward()
-> return out.permute(1,0,2,3)
  0%|                                                                                                                         | 0/18627 [00:00<?, ?it/s]
tensor([[[[-4.3847e-01, -1.2132e+00, -9.7192e-01,  ..., -7.0622e-01,
           -7.9168e-01,  3.3223e-01],
          [ 4.5976e-01, -2.5095e+00, -2.0760e+00,  ..., -1.0877e+00,
           -1.3510e+00,  2.8789e-01],
          [-1.7664e-01, -1.9095e+00, -3.4993e-01,  ..., -7.9414e-01,
           -5.8541e-01,  7.7924e-01],
          ...,
          [-4.8739e-03, -1.1761e+00, -2.2891e-01,  ..., -7.4338e-01,
           -4.8412e-01,  7.5968e-02],
          [ 2.4145e-01,  4.1810e-01,  2.1764e-01,  ..., -5.0967e-01,
           -9.3432e-02,  3.6053e-01],
          [-6.5475e-01, -3.7203e-01, -4.2140e-01,  ..., -1.0933e-01,
            1.5474e-01,  7.9010e-02]]],
        [[[ 4.5709e-01,  2.7440e+00,  2.9963e+00,  ...,  2.9006e+00,
            8.2924e-01,  2.4793e+00],
          [ 1.4051e+00,  2.7720e+00,  1.7450e+00,  ...,  1.7956e+00,
           -4.3600e-01,  1.1163e+00],
          [ 9.1556e-01,  2.8872e+00,  3.5444e+00,  ...,  3.0211e+00,
           -3.6004e-01,  1.6876e+00],
          ...,
          [-2.0735e-01,  1.7100e+00,  1.9109e+00,  ...,  1.1990e+00,
           -4.1399e-01,  9.7321e-01],
          [ 6.7612e-01,  2.5562e+00,  2.4198e+00,  ...,  1.4930e+00,
           -8.7143e-01,  6.4394e-01],
          [-5.6019e-01, -1.1480e-02, -2.7813e-01,  ..., -4.8565e-01,
           -6.3752e-01, -4.2170e-01]]],
        [[[ 1.6633e-01,  2.8052e+00,  2.9121e+00,  ...,  9.7607e-01,
            5.8573e-01,  2.7076e+00],
          [ 3.4450e-01,  1.8709e+00,  2.6079e+00,  ...,  8.2308e-01,
            2.6247e-01,  7.6448e-01],
          [-4.6792e-01,  1.2968e+00,  1.0093e+00,  ..., -9.3612e-01,
           -4.5836e-01,  2.4980e+00],
          ...,
          [-1.0603e+00, -1.0920e+00, -1.5846e+00,  ..., -1.3989e+00,
           -1.2197e+00,  7.7824e-01],
          [-9.3624e-01,  8.5964e-01,  5.3477e-01,  ...,  6.2566e-01,
           -1.3126e+00,  8.1561e-01],
          [-1.3411e+00, -1.2907e-01, -6.6255e-01,  ..., -1.3069e+00,
           -2.4447e+00, -9.1485e-01]]],
        ...,
        [[[-8.7561e-01,  1.3090e+00, -1.2670e+00,  ...,  2.9639e-03,
            4.3032e-01, -4.5016e-02],
          [-2.3346e+00, -2.0482e-01, -3.0769e+00,  ..., -1.2515e+00,
            2.8493e-01,  8.4385e-01],
          [-3.0005e+00,  1.0984e+00, -1.1545e+00,  ...,  5.5717e-01,
            2.0810e+00,  1.6453e+00],
          ...,
          [-3.8584e+00,  1.8727e-01, -1.5890e+00,  ...,  3.0286e-01,
            1.8141e+00,  4.2482e-01],
          [-3.7526e+00, -5.1010e-02,  1.4543e-01,  ...,  8.4729e-02,
            2.4359e+00,  1.3932e+00],
          [-1.3379e+00, -3.7445e-01,  9.6190e-01,  ...,  7.7845e-01,
            6.4536e-01,  1.0389e-01]]],
        [[[-3.9569e-01,  3.6239e-01, -6.5225e-01,  ...,  5.3165e-01,
            2.5625e-01,  4.5615e-01],
          [-1.3743e+00, -9.2922e-01, -2.4828e+00,  ..., -2.1907e+00,
           -1.0769e+00,  3.0810e-01],
          [-1.9653e+00, -3.8738e-01, -2.7262e+00,  ..., -1.7567e+00,
           -6.4234e-01, -9.3164e-01],
          ...,
          [-2.9041e+00, -1.8328e+00, -1.9702e+00,  ..., -9.2061e-01,
           -1.5782e-01, -9.0786e-01],
          [-1.6857e+00, -1.6585e+00,  3.4824e-01,  ...,  3.2947e-01,
            1.3901e+00,  7.4604e-01],
          [-7.4842e-01, -4.7905e-01,  1.7574e-01,  ...,  8.3030e-02,
           -2.4625e-01, -3.6163e-01]]],
        [[[-8.4608e-01, -9.2772e-01, -1.2665e+00,  ..., -1.8282e+00,
           -1.0007e+00, -2.4097e-01],
          [-3.1537e-01, -1.2208e+00, -3.1681e-01,  ..., -3.4847e-01,
            4.0439e-01,  8.0185e-01],
          [-1.0965e+00, -1.1605e+00, -4.5083e-01,  ..., -3.2411e-01,
            1.5974e+00,  8.8353e-01],
          ...,
          [-1.3474e+00, -1.8483e+00, -1.3454e+00,  ..., -7.6364e-01,
           -8.6670e-02,  6.6956e-01],
          [-1.6332e+00, -1.1598e+00,  3.4932e-02,  ...,  1.0005e+00,
            1.2429e+00,  9.6328e-01],
          [-1.7010e+00, -1.1207e+00, -3.9637e-01,  ..., -2.3854e-01,
           -4.1695e-01, -3.8788e-01]]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
torch.Size([32, 1, 32, 64])
  0%|                                                                                                                         | 0/18627 [00:37<?, ?it/s]
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py", line 88, in trainer
    out = model.forward(x=x_past)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 70, in forward
    h,c = self.convLSTMcell(x[:,:,time_step],(h,c))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 107, in forward
    out = self.gated_conv_net(X).cuda()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 158, in forward
    import pdb; pdb.set_trace()
           ^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py", line 88, in trainer
    out = model.forward(x=x_past)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 70, in forward
    h,c = self.convLSTMcell(x[:,:,time_step],(h,c))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 107, in forward
    out = self.gated_conv_net(X).cuda()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/Documents/climsim_ds/models/architectures/conv_lstm_diff.py", line 158, in forward
    import pdb; pdb.set_trace()
           ^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit