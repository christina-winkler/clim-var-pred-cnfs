
Nr of Trainable Params on cuda:   1411716
  0%|                                                                                                                         | 0/18627 [00:00<?, ?it/s]
> /home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py(96)trainer()
-> nll.mean().backward()
tensor([227, 436, 636, 633, 407, 987,   5,   5, 370, 482, 888,  25, 997, 897,
        914, 749], device='cuda:0')
(tensor([[[[[-0.6183, -1.0910, -0.1376,  ..., -0.2761, -0.4089, -0.4943],
           [ 0.6491, -1.5266, -0.8245,  ..., -0.6065,  0.1282, -0.9500],
           [-0.2548,  0.1785, -1.2254,  ..., -0.7096, -0.9200, -0.1431],
           ...,
           [ 0.1010, -1.1449, -0.0261,  ...,  1.1743, -1.0330, -0.2034],
           [-0.1520, -0.1315, -0.0792,  ..., -0.8102,  0.4945, -1.0719],
           [-0.4080, -0.8766, -0.2472,  ..., -0.6777, -0.0541, -0.1162]]],
         [[[-0.1961, -0.8746,  0.4923,  ...,  0.2961,  0.1051, -0.0178],
           [ 1.5755, -1.5479, -0.5425,  ..., -0.2169,  0.8339, -0.7151],
           [ 0.1844,  0.7912, -1.2323,  ..., -0.4075, -0.7294,  0.3628],
           ...,
           [ 0.4397, -1.3443,  0.2726,  ...,  2.0070, -1.1735,  0.0066],
           [ 0.1980,  0.2357,  0.3220,  ..., -0.7514,  1.1183, -1.1264],
           [-0.1334, -0.8021,  0.1046,  ..., -0.5301,  0.3679,  0.2817]]],
         [[[ 0.0565, -0.6705,  0.7935,  ...,  0.5843,  0.3795,  0.2477],
           [ 1.9364, -1.4105, -0.3341,  ...,  0.0196,  1.1441, -0.5161],
           [ 0.4097,  1.0540, -1.1172,  ..., -0.2010, -0.5536,  0.6079],
           ...,
           [ 0.5847, -1.3251,  0.4117,  ...,  2.2744, -1.1382,  0.1221],
           [ 0.3726,  0.4162,  0.5130,  ..., -0.6465,  1.3558, -1.0479],
           [ 0.0314, -0.6835,  0.2892,  ..., -0.3973,  0.5659,  0.4748]]],
         ...,
         [[[ 0.1645, -0.5684,  0.9074,  ...,  0.6969,  0.4904,  0.3574],
           [ 2.0525, -1.3220, -0.2370,  ...,  0.1215,  1.2546, -0.4194],
           [ 0.4987,  1.1459, -1.0444,  ..., -0.1075, -0.4662,  0.7013],
           ...,
           [ 0.6354, -1.2894,  0.4633,  ...,  2.3431, -1.0994,  0.1696],
           [ 0.4405,  0.4857,  0.5850,  ..., -0.5877,  1.4305, -0.9923],
           [ 0.1021, -0.6181,  0.3631,  ..., -0.3316,  0.6399,  0.5485]]],
         [[[ 0.1669, -0.5661,  0.9098,  ...,  0.6992,  0.4927,  0.3597],
           [ 2.0548, -1.3198, -0.2349,  ...,  0.1237,  1.2569, -0.4173],
           [ 0.5006,  1.1478, -1.0427,  ..., -0.1055, -0.4642,  0.7033],
           ...,
           [ 0.6364, -1.2885,  0.4644,  ...,  2.3443, -1.0984,  0.1706],
           [ 0.4419,  0.4872,  0.5865,  ..., -0.5864,  1.4320, -0.9910],
           [ 0.1036, -0.6166,  0.3647,  ..., -0.3301,  0.6415,  0.5500]]],
         [[[ 0.1248, -0.6070,  0.8666,  ...,  0.6562,  0.4501,  0.3173],
           [ 2.0125, -1.3566, -0.2733,  ...,  0.0840,  1.2156, -0.4558],
           [ 0.4665,  1.1136, -1.0729,  ..., -0.1423, -0.4992,  0.6678],
           ...,
           [ 0.6176, -1.3045,  0.4449,  ...,  2.3211, -1.1153,  0.1523],
           [ 0.4160,  0.4607,  0.5592,  ..., -0.6103,  1.4050, -1.0143],
           [ 0.0761, -0.6432,  0.3363,  ..., -0.3564,  0.6135,  0.5220]]]],
        [[[[-0.7519, -0.3121, -0.9936,  ..., -0.7366,  0.3213, -0.7865],
           [-1.1307, -0.8238, -1.3099,  ..., -0.2564, -0.6298, -1.0070],
           [ 0.0612,  0.0418,  0.7646,  ..., -1.7201,  0.0739, -1.0771],
           ...,
           [-0.8024, -0.5788, -0.8353,  ..., -0.3998, -0.7772, -0.5309],
           [ 0.0546, -0.1671, -0.5369,  ..., -0.2943, -0.5439, -0.8850],
           [ 0.5360, -0.2310,  0.8522,  ..., -0.5962,  0.7759, -0.2935]]],
         [[[-0.5115,  0.1167, -0.8634,  ..., -0.4849,  1.0314, -0.5591],
           [-1.0601, -0.6240, -1.3249,  ...,  0.1966, -0.3370, -0.8790],
           [ 0.6673,  0.6400,  1.6730,  ..., -1.9090,  0.6703, -0.9722],
           ...,
           [-0.6689, -0.3373, -0.7026,  ..., -0.1457, -0.6699, -0.2978],
           [ 0.5905,  0.2792, -0.2433,  ...,  0.0859, -0.2737, -0.7614],
           [ 1.3263,  0.2268,  1.7799,  ..., -0.2981,  1.6694,  0.1360]]],
         [[[-0.3291,  0.3428, -0.7080,  ..., -0.2988,  1.3250, -0.3793],
           [-0.9187, -0.4533, -1.2055,  ...,  0.4284, -0.1424, -0.7234],
           [ 0.9384,  0.9093,  2.0145,  ..., -1.8296,  0.9357, -0.8204],
           ...,
           [-0.5306, -0.1711, -0.5614,  ...,  0.0090, -0.5459, -0.1401],
           [ 0.8301,  0.4993, -0.0573,  ...,  0.2881, -0.0977, -0.6195],
           [ 1.6358,  0.4582,  2.1217,  ..., -0.1044,  2.0030,  0.3607]]],
         ...,
         [[[-0.2434,  0.4335, -0.6263,  ..., -0.2121,  1.4247, -0.2937],
           [-0.8387, -0.3701, -1.1290,  ...,  0.5198, -0.0553, -0.6412],
           [ 1.0363,  1.0071,  2.1206,  ..., -1.7574,  1.0312, -0.7378],
           ...,
           [-0.4598, -0.0957, -0.4887,  ...,  0.0757, -0.4810, -0.0690],
           [ 0.9167,  0.5843,  0.0243,  ...,  0.3695, -0.0196, -0.5454],
           [ 1.7360,  0.5489,  2.2258,  ..., -0.0184,  2.1059,  0.4504]]],
         [[[-0.2415,  0.4354, -0.6244,  ..., -0.2102,  1.4267, -0.2918],
           [-0.8368, -0.3682, -1.1271,  ...,  0.5217, -0.0534, -0.6393],
           [ 1.0383,  1.0091,  2.1227,  ..., -1.7556,  1.0332, -0.7359],
           ...,
           [-0.4582, -0.0941, -0.4870,  ...,  0.0771, -0.4795, -0.0674],
           [ 0.9185,  0.5860,  0.0261,  ...,  0.3713, -0.0179, -0.5437],
           [ 1.7379,  0.5508,  2.2278,  ..., -0.0165,  2.1079,  0.4523]]],
         [[[-0.2755,  0.4006, -0.6574,  ..., -0.2445,  1.3899, -0.3258],
           [-0.8695, -0.4014, -1.1589,  ...,  0.4867, -0.0876, -0.6725],
           [ 1.0016,  0.9724,  2.0844,  ..., -1.7866,  0.9974, -0.7694],
           ...,
           [-0.4866, -0.1237, -0.5163,  ...,  0.0511, -0.5057, -0.0954],
           [ 0.8860,  0.5537, -0.0059,  ...,  0.3399, -0.0485, -0.5736],
           [ 1.7015,  0.5162,  2.1905,  ..., -0.0502,  2.0709,  0.4179]]]],
        [[[[-0.4127, -0.9698, -0.7228,  ..., -0.6074, -1.5720,  0.1608],
           [-1.2037, -0.4622, -1.0148,  ..., -1.5529, -1.5695,  0.0415],
           [-1.1116, -0.9161, -1.2713,  ..., -1.2028, -0.2292, -0.1848],
           ...,
           [-0.1237, -0.1529, -1.0259,  ..., -1.3677, -0.5603, -0.8170],
           [-0.8916,  0.1736, -0.2647,  ..., -0.3522, -1.1636, -1.2211],
           [-0.6516, -0.4028,  0.4407,  ..., -1.3153, -1.1467,  0.2147]]],
         [[[-0.0157, -0.8184, -0.4674,  ..., -0.2811, -1.6693,  0.8111],
           [-1.1715, -0.1202, -0.9230,  ..., -1.6287, -1.6680,  0.6289],
           [-1.0373, -0.7633, -1.2696,  ..., -1.1143,  0.2608,  0.3079],
           ...,
           [ 0.4132,  0.3713, -0.8882,  ..., -1.3945, -0.2242, -0.5838],
           [-0.7132,  0.8114,  0.1790,  ...,  0.0648, -1.0980, -1.1821],
           [-0.3861, -0.0298,  1.1791,  ..., -1.3332, -1.0930,  0.8580]]],
         [[[ 0.2056, -0.6558, -0.2810,  ..., -0.0733, -1.5623,  1.0929],
           [-1.0407,  0.0806, -0.7832,  ..., -1.5136, -1.5616,  0.8933],
           [-0.8962, -0.6051, -1.1463,  ..., -0.9578,  0.5069,  0.5510],
           ...,
           [ 0.6705,  0.6257, -0.7264,  ..., -1.2748, -0.0165, -0.3985],
           [-0.5457,  1.0862,  0.4073,  ...,  0.2893, -0.9558, -1.0465],
           [-0.2019,  0.1796,  1.4740,  ..., -1.2146, -0.9579,  1.1313]]],
         ...,
         [[[ 0.2971, -0.5719, -0.1945,  ...,  0.0180, -1.4837,  1.1922],
           [-0.9627,  0.1658, -0.7065,  ..., -1.4326, -1.4834,  0.9893],
           [-0.8167, -0.5242, -1.0692,  ..., -0.8704,  0.6029,  0.6448],
           ...,
           [ 0.7680,  0.7228, -0.6414,  ..., -1.1968,  0.0737, -0.3101],
           [-0.4620,  1.1827,  0.4976,  ...,  0.3804, -0.8746, -0.9663],
           [-0.1181,  0.2664,  1.5712,  ..., -1.1382, -0.8797,  1.2262]]],
         [[[ 0.2990, -0.5700, -0.1926,  ...,  0.0200, -1.4818,  1.1942],
           [-0.9609,  0.1677, -0.7047,  ..., -1.4306, -1.4815,  0.9913],
           [-0.8148, -0.5224, -1.0674,  ..., -0.8683,  0.6049,  0.6467],
           ...,
           [ 0.7700,  0.7248, -0.6395,  ..., -1.1949,  0.0756, -0.3081],
           [-0.4601,  1.1846,  0.4995,  ...,  0.3824, -0.8727, -0.9644],
           [-0.1162,  0.2683,  1.5731,  ..., -1.1364, -0.8779,  1.2281]]],
         [[[ 0.2637, -0.6037, -0.2268,  ..., -0.0157, -1.5149,  1.1572],
           [-0.9929,  0.1346, -0.7359,  ..., -1.4646, -1.5145,  0.9552],
           [-0.8473, -0.5549, -1.0993,  ..., -0.9040,  0.5683,  0.6110],
           ...,
           [ 0.7331,  0.6879, -0.6738,  ..., -1.2274,  0.0404, -0.3432],
           [-0.4937,  1.1487,  0.4649,  ...,  0.3473, -0.9059, -0.9974],
           [-0.1493,  0.2347,  1.5375,  ..., -1.1681, -0.9099,  1.1929]]]],
        ...,
        [[[[-0.6293, -0.5569, -0.3660,  ..., -0.7724, -0.3872, -0.6461],
           [ 0.4022, -0.6411,  0.6180,  ...,  1.0955, -0.0484, -0.2965],
           [-0.7414, -0.1726, -1.0345,  ...,  0.2638, -1.2017, -0.0512],
           ...,
           [-1.4689, -0.1747, -1.6937,  ..., -0.8185, -0.2684, -0.1557],
           [ 0.4368,  0.7156,  0.7286,  ...,  0.5475, -1.0371, -0.3033],
           [ 0.4018, -1.3195, -0.4779,  ..., -1.0274,  0.8053, -0.0287]]],
         [[[-0.2967, -0.1947,  0.0772,  ..., -0.4978,  0.0533, -0.3195],
           [ 1.1464, -0.3417,  1.4692,  ...,  2.1325,  0.4910,  0.1379],
           [-0.5224,  0.3072, -0.9193,  ...,  0.8913, -1.2033,  0.4565],
           ...,
           [-1.7705,  0.0995, -2.0668,  ..., -0.8883, -0.0883,  0.0950],
           [ 1.0194,  1.4275,  1.4536,  ...,  1.1491, -1.1131, -0.0509],
           [ 0.9917, -1.4748, -0.2663,  ..., -1.0674,  1.5645,  0.3714]]],
         [[[-0.0840,  0.0245,  0.3151,  ..., -0.2979,  0.2920, -0.1079],
           [ 1.4478, -0.1431,  1.7987,  ...,  2.5009,  0.7421,  0.3650],
           [-0.3508,  0.5432, -0.7669,  ...,  1.1527, -1.0882,  0.6935],
           ...,
           [-1.7668,  0.2417, -2.0740,  ..., -0.8413,  0.0199,  0.2246],
           [ 1.2436,  1.6839,  1.7147,  ...,  1.3714, -1.0478,  0.0937],
           [ 1.2226, -1.4186, -0.1236,  ..., -0.9866,  1.8338,  0.5571]]],
         ...,
         [[[ 0.0097,  0.1188,  0.4115,  ..., -0.2052,  0.3892, -0.0142],
           [ 1.5483, -0.0542,  1.9041,  ...,  2.6086,  0.8355,  0.4557],
           [-0.2693,  0.6340, -0.6852,  ...,  1.2420, -1.0159,  0.7817],
           ...,
           [-1.7287,  0.2982, -2.0344,  ..., -0.8036,  0.0663,  0.2761],
           [ 1.3149,  1.7601,  1.7922,  ...,  1.4392, -0.9979,  0.1543],
           [ 1.2972, -1.3650, -0.0593,  ..., -0.9313,  1.9125,  0.6259]]],
         [[[ 0.0117,  0.1209,  0.4135,  ..., -0.2032,  0.3913, -0.0121],
           [ 1.5503, -0.0523,  1.9062,  ...,  2.6106,  0.8374,  0.4576],
           [-0.2675,  0.6359, -0.6833,  ...,  1.2438, -1.0142,  0.7835],
           ...,
           [-1.7276,  0.2994, -2.0332,  ..., -0.8027,  0.0673,  0.2772],
           [ 1.3163,  1.7615,  1.7937,  ...,  1.4405, -0.9967,  0.1557],
           [ 1.2987, -1.3636, -0.0578,  ..., -0.9300,  1.9140,  0.6273]]],
         [[[-0.0250,  0.0841,  0.3764,  ..., -0.2398,  0.3538, -0.0489],
           [ 1.5134, -0.0872,  1.8679,  ...,  2.5726,  0.8022,  0.4228],
           [-0.2998,  0.6013, -0.7164,  ...,  1.2108, -1.0441,  0.7502],
           ...,
           [-1.7453,  0.2777, -2.0520,  ..., -0.8187,  0.0493,  0.2575],
           [ 1.2904,  1.7344,  1.7661,  ...,  1.4162, -1.0178,  0.1322],
           [ 1.2715, -1.3867, -0.0831,  ..., -0.9531,  1.8862,  0.6014]]]],
        [[[[-1.0133, -1.3629, -2.0400,  ...,  0.3692, -0.9449, -1.1910],
           [-0.4880, -1.4162, -1.1969,  ..., -0.9667,  0.7029, -0.1563],
           [-0.7246, -0.7799, -1.2789,  ..., -1.2307, -0.7705, -1.3659],
           ...,
           [-0.1053,  0.7819,  0.4564,  ..., -0.4688, -0.0331, -0.0940],
           [-0.4930, -0.2142,  0.5806,  ..., -0.9240, -0.0629, -1.5854],
           [-0.7456, -0.6990, -1.2921,  ..., -0.7002, -0.9161, -1.5233]]],
         [[[-0.8749, -1.3754, -2.3455,  ...,  1.1057, -0.7782, -1.1307],
           [-0.1175, -1.4416, -1.1207,  ..., -0.8255,  1.5746,  0.3500],
           [-0.4525, -0.5197, -1.2310,  ..., -1.2096, -0.5432, -1.3859],
           ...,
           [ 0.2460,  1.5122,  1.0410,  ..., -0.2798,  0.3530,  0.2676],
           [-0.2809,  0.1263,  1.2736,  ..., -0.9204,  0.3210, -1.8555],
           [-0.6048, -0.5345, -1.3818,  ..., -0.5470, -0.8547, -1.7231]]],
         [[[-0.7139, -1.2497, -2.2885,  ...,  1.4066, -0.6109, -0.9883],
           [ 0.0989, -1.3166, -0.9704,  ..., -0.6678,  1.9052,  0.5964],
           [-0.2583, -0.3255, -1.0858,  ..., -1.0813, -0.3650, -1.2634],
           ...,
           [ 0.4168,  1.7706,  1.2642,  ..., -0.1482,  0.5326,  0.4419],
           [-0.1364,  0.3026,  1.5343,  ..., -0.8297,  0.5025, -1.8261],
           [-0.4685, -0.3920, -1.2983,  ..., -0.4094, -0.7383, -1.6675]]],
         ...,
         [[[-0.6296, -1.1695, -2.2166,  ...,  1.5078, -0.5259, -0.9063],
           [ 0.1905, -1.2354, -0.8854,  ..., -0.5858,  2.0089,  0.6907],
           [-0.1689, -0.2349, -1.0006,  ..., -1.0035, -0.2804, -1.1843],
           ...,
           [ 0.4820,  1.8458,  1.3346,  ..., -0.0882,  0.5993,  0.5082],
           [-0.0711,  0.3726,  1.6154,  ..., -0.7734,  0.5706, -1.7757],
           [-0.3999, -0.3222, -1.2353,  ..., -0.3415, -0.6727, -1.6091]]],
         [[[-0.6276, -1.1676, -2.2147,  ...,  1.5098, -0.5240, -0.9044],
           [ 0.1924, -1.2334, -0.8834,  ..., -0.5839,  2.0109,  0.6927],
           [-0.1669, -0.2328, -0.9986,  ..., -1.0016, -0.2785, -1.1824],
           ...,
           [ 0.4834,  1.8472,  1.3360,  ..., -0.0869,  0.6007,  0.5095],
           [-0.0697,  0.3741,  1.6170,  ..., -0.7720,  0.5720, -1.7744],
           [-0.3984, -0.3206, -1.2338,  ..., -0.3399, -0.6712, -1.6076]]],
         [[[-0.6617, -1.2008, -2.2463,  ...,  1.4726, -0.5581, -0.9379],
           [ 0.1569, -1.2672, -0.9181,  ..., -0.6170,  1.9734,  0.6569],
           [-0.2022, -0.2687, -1.0335,  ..., -1.0337, -0.3121, -1.2153],
           ...,
           [ 0.4586,  1.8206,  1.3105,  ..., -0.1105,  0.5755,  0.4844],
           [-0.0953,  0.3473,  1.5878,  ..., -0.7953,  0.5462, -1.7969],
           [-0.4259, -0.3485, -1.2604,  ..., -0.3671, -0.6980, -1.6330]]]],
        [[[[-0.6712, -0.5786, -0.5265,  ..., -0.5621, -1.2267, -0.5933],
           [ 0.9805,  0.3677, -0.5171,  ..., -0.9288,  0.1109, -0.9226],
           [-0.0494, -0.2620, -2.2263,  ..., -0.3011, -1.1208, -0.4390],
           ...,
           [-1.5726,  0.3772, -1.6135,  ...,  0.2527, -0.7590,  0.4308],
           [ 0.1937, -0.5719, -0.1401,  ..., -0.9372, -0.7317, -1.7864],
           [-0.6222, -0.5377, -0.5403,  ..., -0.4432,  0.4623, -0.1874]]],
         [[[-0.2855, -0.1517, -0.0764,  ..., -0.1326, -1.0843, -0.1748],
           [ 1.9918,  1.1164, -0.1490,  ..., -0.7510,  0.7398, -0.7409],
           [ 0.5244,  0.2097, -2.6140,  ...,  0.1628, -1.0034, -0.0266],
           ...,
           [-1.8008,  0.9735, -1.9030,  ...,  0.8214, -0.6193,  1.0862],
           [ 0.7295, -0.3795,  0.2284,  ..., -0.8641, -0.5787, -2.1002],
           [-0.4491, -0.3310, -0.3378,  ..., -0.1829,  1.1126,  0.1777]]],
         [[[-0.0445,  0.0992,  0.1801,  ...,  0.1179, -0.9010,  0.0737],
           [ 2.3595,  1.4232,  0.0691,  ..., -0.5801,  1.0166, -0.5690],
           [ 0.7914,  0.4505, -2.5765,  ...,  0.4039, -0.8417,  0.2042],
           ...,
           [-1.7535,  1.2097, -1.8798,  ...,  1.0570, -0.4823,  1.3442],
           [ 0.9557, -0.2364,  0.4103,  ..., -0.7403, -0.4382, -2.0714],
           [-0.3100, -0.1846, -0.1932,  ..., -0.0213,  1.3653,  0.3627]]],
         ...,
         [[[ 0.0607,  0.2057,  0.2873,  ...,  0.2238, -0.8031,  0.1796],
           [ 2.4699,  1.5265,  0.1620,  ..., -0.4942,  1.1153, -0.4828],
           [ 0.8906,  0.5454, -2.5071,  ...,  0.4999, -0.7544,  0.2999],
           ...,
           [-1.6969,  1.2869, -1.8310,  ...,  1.1370, -0.4131,  1.4280],
           [ 1.0338, -0.1696,  0.4805,  ..., -0.6715, -0.3684, -2.0162],
           [-0.2435, -0.1175, -0.1266,  ...,  0.0491,  1.4464,  0.4352]]],
         [[[ 0.0630,  0.2080,  0.2897,  ...,  0.2261, -0.8008,  0.1819],
           [ 2.4719,  1.5286,  0.1640,  ..., -0.4923,  1.1173, -0.4809],
           [ 0.8926,  0.5474, -2.5053,  ...,  0.5019, -0.7524,  0.3019],
           ...,
           [-1.6954,  1.2884, -1.8297,  ...,  1.1386, -0.4115,  1.4297],
           [ 1.0354, -0.1681,  0.4820,  ..., -0.6699, -0.3668, -2.0147],
           [-0.2420, -0.1160, -0.1251,  ...,  0.0506,  1.4480,  0.4367]]],
         [[[ 0.0219,  0.1666,  0.2481,  ...,  0.1849, -0.8404,  0.1407],
           [ 2.4326,  1.4905,  0.1279,  ..., -0.5267,  1.0804, -0.5154],
           [ 0.8552,  0.5111, -2.5364,  ...,  0.4651, -0.7878,  0.2649],
           ...,
           [-1.7203,  1.2602, -1.8517,  ...,  1.1091, -0.4393,  1.3991],
           [ 1.0064, -0.1946,  0.4553,  ..., -0.6979, -0.3947, -2.0395],
           [-0.2684, -0.1425, -0.1514,  ...,  0.0231,  1.4185,  0.4090]]]]],
       device='cuda:0'), tensor([[[[[ 1.8083e-01, -5.5226e-01,  9.2381e-01,  ...,  7.1325e-01,
             5.0672e-01,  3.7368e-01],
           [ 2.0680e+00, -1.3070e+00, -2.2199e-01,  ...,  1.3686e-01,
             1.2701e+00, -4.0425e-01],
           [ 5.1173e-01,  1.1587e+00, -1.0322e+00,  ..., -9.3190e-02,
            -4.5236e-01,  7.1478e-01],
           ...,
           [ 6.4244e-01, -1.2826e+00,  4.7069e-01,  ...,  2.3511e+00,
            -1.0923e+00,  1.7662e-01],
           [ 4.5031e-01,  4.9578e-01,  5.9536e-01,  ..., -5.7817e-01,
             1.4404e+00, -9.8281e-01],
           [ 1.1274e-01, -6.0748e-01,  3.7395e-01,  ..., -3.2125e-01,
             6.5051e-01,  5.5913e-01]]]],
        [[[[-2.3011e-01,  4.4685e-01, -6.1312e-01,  ..., -1.9871e-01,
             1.4383e+00, -2.8038e-01],
           [-8.2556e-01, -3.5700e-01, -1.1161e+00,  ...,  5.3315e-01,
            -4.1958e-02, -6.2796e-01],
           [ 1.0501e+00,  1.0209e+00,  2.1345e+00,  ..., -1.7446e+00,
             1.0447e+00, -7.2445e-01],
           ...,
           [-4.4849e-01, -8.4131e-02, -4.7711e-01,  ...,  8.5763e-02,
            -4.7062e-01, -5.8050e-02],
           [ 9.2887e-01,  5.9656e-01,  3.6695e-02,  ...,  3.8156e-01,
            -7.6719e-03, -5.3352e-01],
           [ 1.7494e+00,  5.6214e-01,  2.2393e+00,  ..., -5.3059e-03,
             2.1193e+00,  4.6358e-01]]]],
        [[[[ 3.1066e-01, -5.5847e-01, -1.8114e-01,  ...,  3.1910e-02,
            -1.4702e+00,  1.2061e+00],
           [-9.4977e-01,  1.7863e-01, -6.9409e-01,  ..., -1.4187e+00,
            -1.4699e+00,  1.0028e+00],
           [-8.0367e-01, -5.1132e-01, -1.0564e+00,  ..., -8.5613e-01,
             6.1687e-01,  6.5835e-01],
           ...,
           [ 7.8203e-01,  7.3678e-01, -6.2779e-01,  ..., -1.1836e+00,
             8.7306e-02, -2.9630e-01],
           [-4.4879e-01,  1.1961e+00,  5.1085e-01,  ...,  3.9388e-01,
            -8.6132e-01, -9.5303e-01],
           [-1.0520e-01,  2.7934e-01,  1.5843e+00,  ..., -1.1254e+00,
            -8.6684e-01,  1.2394e+00]]]],
        ...,
        [[[[ 2.3952e-02,  1.3306e-01,  4.2571e-01,  ..., -1.9091e-01,
             4.0358e-01,  1.1180e-04],
           [ 1.5619e+00, -4.0632e-02,  1.9181e+00,  ...,  2.6222e+00,
             8.4878e-01,  4.6898e-01],
           [-2.5664e-01,  6.4718e-01, -6.7199e-01,  ...,  1.2543e+00,
            -1.0038e+00,  7.9429e-01],
           ...,
           [-1.7211e+00,  3.0645e-01, -2.0261e+00,  ..., -7.9703e-01,
             7.3325e-02,  2.8361e-01],
           [ 1.3243e+00,  1.7698e+00,  1.8021e+00,  ...,  1.4480e+00,
            -9.8926e-01,  1.6341e-01],
           [ 1.3072e+00, -1.3553e+00, -4.9394e-02,  ..., -9.2189e-01,
             1.9224e+00,  6.3572e-01]]]],
        [[[[-6.1603e-01, -1.1560e+00, -2.2032e+00,  ...,  1.5216e+00,
            -5.1242e-01, -8.9286e-01],
           [ 2.0420e-01, -1.2217e+00, -8.7153e-01,  ..., -5.7270e-01,
             2.0225e+00,  7.0436e-01],
           [-1.5513e-01, -2.2079e-01, -9.8651e-01,  ..., -9.9052e-01,
            -2.6719e-01, -1.1710e+00],
           ...,
           [ 4.9142e-01,  1.8553e+00,  1.3439e+00,  ..., -7.9003e-02,
             6.0882e-01,  5.1771e-01],
           [-6.1074e-02,  3.8287e-01,  1.6261e+00,  ..., -7.6395e-01,
             5.8036e-01, -1.7661e+00],
           [-3.8905e-01, -3.1122e-01, -1.2244e+00,  ..., -3.3074e-01,
            -6.6202e-01, -1.5985e+00]]]],
        [[[[ 7.6617e-02,  2.2172e-01,  3.0337e-01,  ...,  2.3967e-01,
            -7.8729e-01,  1.9557e-01],
           [ 2.4840e+00,  1.5406e+00,  1.7599e-01,  ..., -4.8061e-01,
             1.1291e+00, -4.6920e-01],
           [ 9.0474e-01,  5.5928e-01, -2.4939e+00,  ...,  5.1396e-01,
            -7.4029e-01,  3.1409e-01],
           ...,
           [-1.6864e+00,  1.2972e+00, -1.8216e+00,  ...,  1.1480e+00,
            -4.0212e-01,  1.4393e+00],
           [ 1.0446e+00, -1.5927e-01,  4.9072e-01,  ..., -6.6027e-01,
            -3.5737e-01, -2.0056e+00],
           [-2.3305e-01, -1.0717e-01, -1.1635e-01,  ...,  5.9758e-02,
             1.4572e+00,  4.4575e-01]]]]], device='cuda:0'))
*** AttributeError: 'tuple' object has no attribute 'shape'
NameError: name 'nll' is not defined
> /home/christina/Documents/climsim_ds/optimization/trainer_stdiff.py(96)trainer()
-> nll.mean().backward()
tensor([[[[[-9.2466e-01, -4.2534e-01, -2.6438e+00,  ...,  1.2103e-01,
             4.7297e-01, -1.0823e+00],
           [-3.3446e-02, -9.7344e-01,  9.5592e-01,  ..., -2.1282e-01,
            -3.3148e-01, -2.0226e-01],
           [-1.1451e+00, -5.7146e-01, -6.5101e-01,  ...,  2.1443e-01,
            -7.3694e-01, -4.5156e-01],
           ...,
           [ 6.6076e-02, -1.4859e+00,  6.9994e-01,  ..., -5.5272e-01,
             6.2457e-01,  1.0373e+00],
           [ 2.6943e-01,  1.4354e-02, -1.2653e+00,  ..., -6.4042e-01,
             5.0417e-01,  4.5639e-02],
           [-7.4096e-01, -1.9390e+00,  1.5943e-02,  ...,  1.4661e+00,
            -5.6226e-02,  4.5702e-02]]]],
        [[[[ 1.4954e+00, -1.5724e+00,  3.3130e-01,  ...,  1.0699e+00,
             1.0663e+00,  9.0135e-01],
           [ 7.9167e-01,  2.1276e-01,  8.0331e-01,  ..., -9.8361e-01,
            -1.1608e+00, -3.1093e-01],
           [ 3.4854e-01,  1.2439e-01, -1.2934e+00,  ...,  1.0270e+00,
            -7.3524e-03, -4.2253e-01],
           ...,
           [ 1.6796e-01, -6.9384e-01, -8.6282e-01,  ...,  6.8091e-01,
             6.4480e-01, -1.9713e-02],
           [-1.5257e-02,  6.8721e-01,  1.7104e-01,  ..., -5.3091e-01,
             5.5130e-02, -6.6630e-02],
           [ 6.2924e-01,  9.9338e-01,  9.0785e-01,  ...,  1.6040e+00,
            -1.0725e+00,  1.6008e+00]]]],
        [[[[ 2.2892e+00,  1.5158e-01,  2.0667e+00,  ..., -8.8937e-01,
             1.1093e+00,  5.9784e-01],
           [-4.3648e-01,  4.6046e-01,  3.5814e-01,  ...,  1.7482e-01,
            -1.0581e+00, -1.2234e+00],
           [ 1.0032e+00,  7.2371e-01, -1.6225e+00,  ..., -8.0137e-01,
            -1.7140e-01,  9.5412e-02],
           ...,
           [ 5.1255e-02, -9.1229e-01,  3.4327e-01,  ..., -1.1193e-01,
            -7.3305e-01, -1.3541e+00],
           [ 4.7226e-01, -1.5770e+00,  1.3283e+00,  ..., -1.8412e+00,
             7.3835e-01,  1.6189e+00],
           [ 7.3566e-01, -2.6284e-01,  7.8858e-01,  ...,  1.0108e+00,
            -2.3721e-01, -7.9002e-01]]]],
        ...,
        [[[[ 2.0706e-01,  2.9032e-01, -8.8149e-01,  ...,  6.9443e-01,
             2.6849e+00,  1.2025e-01],
           [ 3.8004e-02,  2.8791e-01,  2.4102e-01,  ...,  2.6279e-01,
            -2.1793e+00, -3.0390e-01],
           [ 3.0241e-01, -4.8127e-01,  6.4295e-01,  ..., -6.2035e-01,
             6.7101e-04,  9.9300e-02],
           ...,
           [-2.8000e-01, -1.4489e+00, -1.3460e+00,  ...,  8.1681e-02,
            -6.9172e-01, -2.4286e-01],
           [ 1.6306e-01,  1.3735e+00, -8.4472e-01,  ...,  9.3257e-01,
             1.3080e+00, -5.2033e-01],
           [ 2.3261e-01, -4.5250e-01, -9.1270e-01,  ..., -1.8719e+00,
             3.5349e-01, -1.5940e-01]]]],
        [[[[-3.3985e-01,  8.2869e-01,  3.4352e-01,  ..., -5.5974e-01,
             5.7025e-01,  7.3562e-01],
           [ 3.9467e-01, -4.8568e-01, -5.5518e-01,  ...,  8.9581e-01,
             9.5175e-01, -9.4105e-01],
           [-1.1348e+00,  1.9808e+00, -8.0943e-01,  ...,  1.1851e+00,
            -1.5103e+00, -1.9105e-01],
           ...,
           [ 9.8471e-01,  7.7252e-01, -3.6710e-01,  ...,  1.0564e+00,
            -2.9899e-01,  8.8693e-01],
           [-6.9243e-01, -2.8641e+00,  8.2983e-01,  ...,  1.1458e+00,
             1.0514e-01,  5.0476e-01],
           [-8.3149e-01,  3.5711e-01, -1.0701e+00,  ..., -7.2152e-01,
             5.0877e-01,  7.4841e-01]]]],
        [[[[ 4.2918e-01,  5.5395e-01,  1.0435e+00,  ...,  3.8669e-01,
            -2.1716e-01,  1.8448e+00],
           [ 6.1768e-01,  8.0480e-01, -1.6825e+00,  ...,  1.3837e-01,
             1.3796e+00, -5.5990e-01],
           [-5.1308e-01,  4.3659e-01,  1.4612e-01,  ...,  1.6016e+00,
            -5.2223e-01, -1.5399e+00],
           ...,
           [ 7.8792e-01, -4.1218e-01, -4.4327e-01,  ...,  1.7708e+00,
             9.6563e-01, -2.9298e-01],
           [ 4.8083e-01,  3.8054e-01,  8.3391e-01,  ...,  4.1951e-01,
             1.2259e-01, -3.9588e-01],
           [ 6.4717e-01,  9.5575e-01,  1.7189e+00,  ..., -9.3885e-01,
            -9.5596e-01, -1.0169e+00]]]]], device='cuda:0')
torch.Size([16, 1, 1, 32, 64])
torch.Size([16, 16, 1, 32, 64])
tensor([227, 436, 636, 633, 407, 987,   5,   5, 370, 482, 888,  25, 997, 897,
  0%|                                                                                                                         | 0/18627 [09:19<?, ?it/s]
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 96, in trace_dispatch
    return self.dispatch_exception(frame, arg)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 176, in dispatch_exception
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit
Traceback (most recent call last):
  File "/home/christina/Documents/climsim_ds/main.py", line 354, in <module>
    main(args)
  File "/home/christina/Documents/climsim_ds/main.py", line 153, in main
    trainer_stdiff.trainer(args=args, train_loader=train_loader,
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 96, in trace_dispatch
    return self.dispatch_exception(frame, arg)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/christina/anaconda3/envs/stflow/lib/python3.11/bdb.py", line 176, in dispatch_exception
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit